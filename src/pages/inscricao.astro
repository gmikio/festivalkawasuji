---
import Layout from "@layouts/Layout.astro";
---

<Layout title="Inscrições Gerais - XVII Festival Kawasuji de Taiko">
  <main class="min-h-screen flex flex-col items-center">
    <!-- Header Section -->
    <header class="text-center py-12">
      <h1 class="text-4xl font-bold text-[#101a61]">INSCRIÇÕES GERAIS</h1>
      <h2 class="text-2xl font-bold text-[#101a61] mt-4">
        XVII FESTIVAL KAWASUJI DE TAIKO
      </h2>
    </header>

    <!-- Main Content -->
    <div class="w-full max-w-4xl px-4 py-8 bg-white rounded-lg shadow-lg mb-12">
      <section class="text-center mb-8">
        <p class="text-lg text-slate-700">
          Depois de muita espera, estão finalmente abertas as inscrições gerais
          para o 17º Festival Kawasuji de Taiko!
        </p>
        <button
          class="bg-[#9e0101] text-white py-2 px-6 rounded-full mt-6 hover:bg-[#530101]"
          onclick="document.getElementById('calculator').scrollIntoView({ behavior: 'smooth' })">
          Prosseguir
        </button>
      </section>

      <!-- Calculator Section -->
      <section
        id="calculator"
        class="bg-[#f9f9f9] p-8 rounded-lg shadow-md mt-8">
        <h2 class="text-2xl font-bold text-[#101a61] text-center mb-6">
          Calculadora de Custos do Evento
        </h2>

        <div id="group-calculator" class="space-y-8">
          <!-- Tópico 1 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              1. Inscrição (Grupo)
            </h3>
            <div class="pl-6">
              <label for="uf-group" class="block text-lg text-slate-700">
                a. Estado do grupo:
              </label>
              <select
                id="uf-group"
                class="w-full p-2 border rounded-md text-slate-600">
                <option value="">Selecione</option>
                <option>AC</option>
                <option>AL</option>
                <option>AP</option>
                <option>AM</option>
                <option>BA</option>
                <option>CE</option>
                <option>DF</option>
                <option>ES</option>
                <option>GO</option>
                <option>MA</option>
                <option>MT</option>
                <option>MS</option>
                <option>MG</option>
                <option>PA</option>
                <option>PB</option>
                <option>PR</option>
                <option>PE</option>
                <option>PI</option>
                <option>RJ</option>
                <option>RN</option>
                <option>RS</option>
                <option>RO</option>
                <option>RR</option>
                <option>SC</option>
                <option>SP</option>
                <option>SE</option>
                <option>TO</option>
              </select>
            </div>
          </div>

          <!-- Tópico 2 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              2. Alimentação (Adultos)
            </h3>
            <div class="pl-6">
              <label for="qtd-adults-a" class="block text-lg text-slate-700">
                a. Pacote A (todas as refeições e todos os cafés):
              </label>
              <input
                type="number"
                id="qtd-adults-a"
                class="w-full p-2 border rounded-md"
              />
              <label
                for="qtd-adults-b"
                class="block text-lg text-slate-700 mt-4">
                b. Pacote B (sem cafés da manhã):
              </label>
              <input
                type="number"
                id="qtd-adults-b"
                class="w-full p-2 border rounded-md"
              />
              <label
                for="qtd-adults-c"
                class="block text-lg text-slate-700 mt-4">
                c. Pacote C (só cafés e refeições de domingo):
              </label>
              <input
                type="number"
                id="qtd-adults-c"
                class="w-full p-2 border rounded-md"
              />
            </div>
          </div>

          <!-- Tópico 3 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              3. Alimentação (Crianças)
            </h3>
            <div class="pl-6">
              <label for="qtd-children-a" class="block text-lg text-slate-700">
                a. Pacote A (todas as refeições e todos os cafés):
              </label>
              <input
                type="number"
                id="qtd-children-a"
                class="w-full p-2 border rounded-md"
              />
              <label
                for="qtd-children-b"
                class="block text-lg text-slate-700 mt-4">
                b. Pacote B (sem cafés da manhã):
              </label>
              <input
                type="number"
                id="qtd-children-b"
                class="w-full p-2 border rounded-md"
              />
              <label
                for="qtd-children-c"
                class="block text-lg text-slate-700 mt-4">
                c. Pacote C (só cafés e refeições de domingo):
              </label>
              <input
                type="number"
                id="qtd-children-c"
                class="w-full p-2 border rounded-md"
              />
            </div>
          </div>

          <!-- Tópico 4 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              4. Pernoite (Adultos e Crianças)
            </h3>
            <div class="pl-6">
              <label for="qtd-pernoite" class="block text-lg text-slate-700">
                a. Quantidade de pessoas a pernoite:
              </label>
              <input
                type="number"
                id="qtd-pernoite"
                class="w-full p-2 border rounded-md"
              />
            </div>
          </div>
        </div>

        <!-- Calculadora Individual -->
        <div id="individual-calculator" class="space-y-8 hidden">
          <!-- Tópico 1 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              1. Inscrição (Individual)
            </h3>
            <div class="pl-6">
              <label for="qtd-workshop" class="block text-lg text-slate-700">
                a. Quantidade de tocadores que participarão do Workshop:
              </label>
              <input
                type="number"
                id="qtd-workshop"
                class="w-full p-2 border rounded-md text-slate-600"
                min="0"
              />
            </div>
          </div>

          <!-- Tópico 2 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              2. Alimentação (Adultos)
            </h3>
            <div class="pl-6">
              <label
                for="qtd-adults-a-individual"
                class="block text-lg text-slate-700">
                a. Pacote A (todas as refeições e todos os cafés):
              </label>
              <input
                type="number"
                id="qtd-adults-a-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
              <label
                for="qtd-adults-b-individual"
                class="block text-lg text-slate-700 mt-4">
                b. Pacote B (sem cafés da manhã):
              </label>
              <input
                type="number"
                id="qtd-adults-b-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
              <label
                for="qtd-adults-c-individual"
                class="block text-lg text-slate-700 mt-4">
                c. Pacote C (só cafés e refeições de domingo):
              </label>
              <input
                type="number"
                id="qtd-adults-c-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
            </div>
          </div>

          <!-- Tópico 3 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              3. Alimentação (Crianças)
            </h3>
            <div class="pl-6">
              <label
                for="qtd-children-a-individual"
                class="block text-lg text-slate-700">
                a. Pacote A (todas as refeições e todos os cafés):
              </label>
              <input
                type="number"
                id="qtd-children-a-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
              <label
                for="qtd-children-b-individual"
                class="block text-lg text-slate-700 mt-4">
                b. Pacote B (sem cafés da manhã):
              </label>
              <input
                type="number"
                id="qtd-children-b-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
              <label
                for="qtd-children-c-individual"
                class="block text-lg text-slate-700 mt-4">
                c. Pacote C (só cafés e refeições de domingo):
              </label>
              <input
                type="number"
                id="qtd-children-c-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
            </div>
          </div>

          <!-- Tópico 4 -->
          <div>
            <h3 class="text-xl font-bold text-[#101a61]">
              4. Pernoite (Adultos e Crianças)
            </h3>
            <div class="pl-6">
              <label
                for="qtd-pernoite-individual"
                class="block text-lg text-slate-700">
                a. Quantidade de pessoas a pernoite:
              </label>
              <input
                type="number"
                id="qtd-pernoite-individual"
                class="w-full p-2 border rounded-md"
                min="0"
              />
            </div>
          </div>
        </div>

        <div class="text-center mt-6">
          <button
            class="bg-[#2641c6ff] text-white py-2 px-6 rounded-full hover:bg-[#101a61ff]"
            id="calculate-button">
            Calcular Total
          </button>
          <div class="mt-6 text-center">
            <p id="result" class="text-2xl font-bold mb-6 text-[#2641c6ff]"></p>
            <a
              id="form-link"
              href="#"
              class="hidden bg-[#9e0101] text-white py-2 px-6 rounded-full mt-6 hover:bg-[#530101]"
              target="_blank">
              Ir para Formulário
            </a>
          </div>
          <div class="text-center mt-4">
            <button class="text-blue-500 underline" id="toggle-calculator">
              Obs: É uma Inscrição Individual?
            </button>
          </div>
        </div>
      </section>

      <script>
        const toggleButton = document.getElementById("toggle-calculator");
        const groupCalculator = document.getElementById("group-calculator");
        const individualCalculator = document.getElementById(
          "individual-calculator"
        );
        const calculateButton = document.getElementById("calculate-button");
        const resultElement = document.getElementById("result");
        const formLink = document.getElementById(
          "form-link"
        ) as HTMLAnchorElement;

        if (
          toggleButton &&
          groupCalculator &&
          individualCalculator &&
          calculateButton &&
          resultElement &&
          formLink
        ) {
          toggleButton.addEventListener("click", () => {
            groupCalculator.classList.toggle("hidden");
            individualCalculator.classList.toggle("hidden");
            resultElement.textContent = "";
            formLink.classList.add("hidden");
            toggleButton.innerText = groupCalculator.classList.contains(
              "hidden"
            )
              ? "Voltar para Inscrição de Grupo"
              : "Obs: É uma Inscrição Individual?";
          });

          calculateButton.addEventListener("click", () => {
            let total = 0;
            let formUrlBase = "";

            if (!groupCalculator.classList.contains("hidden")) {
              // Lógica para Grupos

              const uf =
                (document.getElementById("uf-group") as HTMLSelectElement)
                  ?.value || "";
              const qtdAdultsA =
                parseInt(
                  (document.getElementById("qtd-adults-a") as HTMLInputElement)
                    ?.value
                ) || 0;
              const qtdAdultsB =
                parseInt(
                  (document.getElementById("qtd-adults-b") as HTMLInputElement)
                    ?.value
                ) || 0;
              const qtdAdultsC =
                parseInt(
                  (document.getElementById("qtd-adults-c") as HTMLInputElement)
                    ?.value
                ) || 0;
              const qtdChildrenA =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-children-a"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdChildrenB =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-children-b"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdChildrenC =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-children-c"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdPernoite =
                parseInt(
                  (document.getElementById("qtd-pernoite") as HTMLInputElement)
                    ?.value
                ) || 0;

              const baseCost = uf === "SP" ? 1000 : 750;
              const costAdults =
                qtdAdultsA * 192 + qtdAdultsB * 156 + qtdAdultsC * 76;
              const costChildren =
                qtdChildrenA * 123 + qtdChildrenB * 99 + qtdChildrenC * 49;
              const lodgingCost = qtdPernoite * 30;

              total = baseCost + costAdults + costChildren + lodgingCost;

              const idUF = "entry.369296670";
              const adultsAEntryId = "entry.1549837914";
              const adultsBEntryId = "entry.1620428975";
              const adultsCEntryId = "entry.613161222";
              const childrenAEntryId = "entry.1504630669";
              const childrenBEntryId = "entry.1544858428";
              const childrenCEntryId = "entry.162310338";
              const lodgingEntryId = "entry.1083938500";

              formUrlBase =
                "https://docs.google.com/forms/d/e/1FAIpQLSfjykJCpEdSFS8YzgrZOHKo9gx0Z0WKYO4BLOKmwOynmsWKIw/viewform?usp=pp_url&";

              const formUrl =
                formUrlBase +
                `${idUF}=${uf}&${adultsAEntryId}=${qtdAdultsA}&${adultsBEntryId}=${qtdAdultsB}&${adultsCEntryId}=${qtdAdultsC}&${childrenAEntryId}=${qtdChildrenA}&${childrenBEntryId}=${qtdChildrenB}&${childrenCEntryId}=${qtdChildrenC}&${lodgingEntryId}=${qtdPernoite}`;

              formLink.href = formUrl;
            } else {
              // Lógica para Inscrição Individual

              const qtdWorkshop =
                parseInt(
                  (document.getElementById("qtd-workshop") as HTMLInputElement)
                    ?.value
                ) || 0;
              const qtdAdultsA =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-adults-a-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdAdultsB =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-adults-b-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdAdultsC =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-adults-c-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdChildrenA =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-children-a-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdChildrenB =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-children-b-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdChildrenC =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-children-c-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;
              const qtdPernoite =
                parseInt(
                  (
                    document.getElementById(
                      "qtd-pernoite-individual"
                    ) as HTMLInputElement
                  )?.value
                ) || 0;

              const costAdults =
                qtdAdultsA * 192 + qtdAdultsB * 156 + qtdAdultsC * 76;
              const costChildren =
                qtdChildrenA * 123 + qtdChildrenB * 99 + qtdChildrenC * 49;
              const lodgingCost = qtdPernoite * 30;

              total =
                qtdWorkshop * 150 + costAdults + costChildren + lodgingCost;

              const workshopEntryId = "entry.675671558";
              const adultsAEntryId = "entry.1549837914";
              const adultsBEntryId = "entry.2055184223";
              const adultsCEntryId = "entry.1272089818";
              const childrenAEntryId = "entry.1889870500";
              const childrenBEntryId = "entry.1623159929";
              const childrenCEntryId = "entry.1057151001";
              const lodgingEntryId = "entry.1083938500";

              formUrlBase =
                "https://docs.google.com/forms/d/e/1FAIpQLSeaHhdD_0Y9_fh1F-T6Q_2yTPuQNUzDpHta1JIs3sfdD1YZ7Q/viewform?usp=pp_url&";

              const formUrl =
                formUrlBase +
                `${workshopEntryId}=${qtdWorkshop}&${adultsAEntryId}=${qtdAdultsA}&${adultsBEntryId}=${qtdAdultsB}&${adultsCEntryId}=${qtdAdultsC}&${childrenAEntryId}=${qtdChildrenA}&${childrenBEntryId}=${qtdChildrenB}&${childrenCEntryId}=${qtdChildrenC}&${lodgingEntryId}=${qtdPernoite}`;

              formLink.href = formUrl;
            }

            resultElement.textContent = `Valor Total: R$ ${total.toFixed(2)}`;
            formLink.classList.remove("hidden");
          });
        }
      </script>
    </div>
  </main>
</Layout>
